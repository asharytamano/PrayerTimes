<Window x:Class="PrayerTimes.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings" Height="560" Width="560"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Grid Margin="22">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="16"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="16"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header (matching main) -->
        <Border Grid.Row="0" Style="{StaticResource Card}" Padding="0" ClipToBounds="True">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="16"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Background="{DynamicResource AccentBrush}"/>

                <Border Grid.Row="1" Background="{DynamicResource ParchmentBrush}">
                    <Grid Margin="14">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="14"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Border Width="56" Height="56" CornerRadius="28" BorderThickness="2" BorderBrush="{DynamicResource GoldBrush}">
                            <Border Background="{DynamicResource ParchmentSoftBrush}" CornerRadius="26" Margin="2">
                                <Image Source="pack://application:,,,/Assets/Images/HabibTamano.png" Stretch="UniformToFill"/>
                            </Border>
                        </Border>

                        <StackPanel Grid.Column="2" VerticalAlignment="Center">
                            <TextBlock Text="SETTINGS" Style="{StaticResource TitleH2}" Foreground="{DynamicResource AccentBrush}"/>
                            <TextBlock Text="Location and calculation options" Opacity="0.80" Margin="0,2,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <Border Grid.Row="2" Background="{DynamicResource GoldBrush}"/>
            </Grid>
        </Border>

        <!-- Form -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <Border Style="{StaticResource Card}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="12"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="20"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="12"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Location -->
                    <StackPanel Grid.Row="0">
                        <TextBlock Text="Location" FontWeight="SemiBold" FontSize="14"/>
                        <TextBlock Text="Search a location (offline list) or type manually." FontSize="12" Opacity="0.70" Margin="0,2,0,0"/>
                    </StackPanel>


                    <Grid Grid.Row="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <!-- 0 Search -->
                            <RowDefinition Height="10"/>
                            <!-- 1 -->
                            <RowDefinition Height="Auto"/>
                            <!-- 2 label -->
                            <RowDefinition Height="10"/>
                            <!-- 3 -->
                            <RowDefinition Height="140"/>
                            <!-- 4 list -->
                            <RowDefinition Height="16"/>
                            <!-- 5 -->
                            <RowDefinition Height="Auto"/>
                            <!-- 6 City -->
                            <RowDefinition Height="10"/>
                            <!-- 7 -->
                            <RowDefinition Height="Auto"/>
                            <!-- 8 Lat -->
                            <RowDefinition Height="10"/>
                            <!-- 9 -->
                            <RowDefinition Height="Auto"/>
                            <!-- 10 Lon -->
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="170"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Search" VerticalAlignment="Center" Opacity="0.85"/>
                        <TextBox Grid.Row="0" Grid.Column="1"
                             Text="{Binding LocationQuery, UpdateSourceTrigger=PropertyChanged}"
                             ToolTip="Type at least 2 letters (e.g., Tugaya, Marawi, Cotabato)"
                             Background="White" Foreground="Black"
                             BorderBrush="#8A8A8A" BorderThickness="1"
                             Padding="6"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Results" VerticalAlignment="Top" Opacity="0.85"/>
                        <TextBlock Grid.Row="3" Grid.Column="1"
                                   Text="Tip: type 2+ letters. If nothing appears, make sure locations_ph.json is copied to the output folder."
                                   FontSize="12" Opacity="0.70" Margin="0,0,0,2"/>

                        <ListBox Grid.Row="2" Grid.Column="1" Grid.RowSpan="3"
                             ItemsSource="{Binding LocationMatches}"
                             SelectedItem="{Binding SelectedLocation}"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             Background="White" Foreground="Black"
                             BorderBrush="#8A8A8A" BorderThickness="1"
                             MinHeight="120">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Margin="6,4">
                                        <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold"/>
                                        <TextBlock Text="{Binding SubText}" FontSize="12" Opacity="0.75"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>

                        <TextBlock Grid.Row="6" Grid.Column="0" Text="City name" VerticalAlignment="Center" Opacity="0.85"/>
                        <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding DraftCityName, UpdateSourceTrigger=PropertyChanged}"
                                Background="White" Foreground="Black"
                                BorderBrush="#8A8A8A" BorderThickness="1"
                                Padding="6"/>

                        <TextBlock Grid.Row="8" Grid.Column="0" Text="Latitude" VerticalAlignment="Center" Opacity="0.85"/>
                        <TextBox Grid.Row="8" Grid.Column="1" Text="{Binding DraftLatitude, UpdateSourceTrigger=PropertyChanged}"
                                Background="White" Foreground="Black"
                                BorderBrush="#8A8A8A" BorderThickness="1"
                                Padding="6"/>

                        <TextBlock Grid.Row="10" Grid.Column="0" Text="Longitude" VerticalAlignment="Center" Opacity="0.85"/>
                        <TextBox Grid.Row="10" Grid.Column="1" Text="{Binding DraftLongitude, UpdateSourceTrigger=PropertyChanged}"
                                Background="White" Foreground="Black"
                                BorderBrush="#8A8A8A" BorderThickness="1"
                                Padding="6"/>
                    </Grid>

                    <StackPanel Grid.Row="4">
                        <TextBlock Text="Calculation" FontWeight="SemiBold" FontSize="14"/>
                        <TextBlock Text="Select the method and madhhab you prefer." FontSize="12" Opacity="0.70" Margin="0,2,0,0"/>
                    </StackPanel>

                    <Grid Grid.Row="6">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="10"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="18"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="10"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="170"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Calculation method" VerticalAlignment="Center" Opacity="0.85"/>
                        <ComboBox Grid.Row="0" Grid.Column="1"
                              ItemsSource="{Binding Methods}"
                              SelectedItem="{Binding DraftMethod}"
                              Background="White" Foreground="Black"
                              BorderBrush="#8A8A8A" BorderThickness="1"
                              Padding="4"/>

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Madhhab (Asr)" VerticalAlignment="Center" Opacity="0.85"/>
                        <ComboBox Grid.Row="2" Grid.Column="1"
                              ItemsSource="{Binding Madhhabs}"
                              SelectedItem="{Binding DraftMadhhab}"
                              Background="White" Foreground="Black"
                              BorderBrush="#8A8A8A" BorderThickness="1"
                              Padding="4"/>

                        <CheckBox Grid.Row="4" Grid.ColumnSpan="2"
                              Content="Enable notifications"
                              IsChecked="{Binding DraftNotificationsEnabled}" />

                        <TextBlock Grid.Row="6" Grid.Column="0" Text="Reminder (minutes)" VerticalAlignment="Center" Opacity="0.85"/>
                        <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding DraftReminderMinutes, UpdateSourceTrigger=PropertyChanged}"
                                Background="White" Foreground="Black"
                                BorderBrush="#8A8A8A" BorderThickness="1"
                                Padding="6"/>
                    </Grid>
                </Grid>
            </Border>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Style="{StaticResource BtnSecondary}" Content="Cancel" Width="104" Margin="0,0,10,0" IsCancel="True" Click="Cancel_Click"/>
            <Button Content="Save" Width="104" IsDefault="True" Click="Save_Click"/>
        </StackPanel>
    </Grid>
</Window>
